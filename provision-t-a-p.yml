---

- hosts: php-apps:java-apps
  sudo: true
  roles:
    - common
    - tls
    - httpd

- hosts: storage
  sudo: true
  roles:
    - mysql

- hosts: php-apps
  sudo: yes
  gather_facts: no
  vars:
    env_lang: php
  roles:
    - php
    - static
    - { role: openconext-common, tags: ['eb','sr']}
    - { role: openconext-engineblock, tags: ['eb'] }
    - { role: janus, tags: ['sr'] }

- hosts: java-apps
  sudo: true
  vars:
    env_lang: java
  roles:
    - tomcat
    - java
    - { role: shibboleth, tags: ['shib'] }
    - grouper
    - teams
    - api
    - apis
    - { role: authz-server, tags: ['oauth', 'authz'] }
    - { role: authz-admin, tags: ['oauth', 'authz-admin'] }
    - { role: voot, tags: ['oauth', 'voot'] }
    - { role: authz-playground, tags: ['oauth', 'authz-playground'] }
